<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>exp_assignment2: Main Page</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">exp_assignment2 Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="manifest" style="padding: 5px; background-color: #eee; border: 1px solid #333; float: right; width: 25%;">
<h3>exp_assignment2</h3>
<p class=description><em>Second assignment of the course Experimental Robotics Laboratory</em></p>
<p>
<ul>
<li>Homepage: <a href="http://wiki.ros.org/exp_assignment2">http://wiki.ros.org/exp_assignment2</a></li>
</ul>
</p>

</div>
<p><b>Package</b> for the assignment 2 of Esperimental Robotics Laboratory</p>
<h1>Experimental Robotics Laboratory - Assignment 2</h1>
<h2>Riccardo Lastrico - 4070551</h2>
<h3>Assignment contents</h3>
<p>The assignment content is an exercise based on ROS about a finite state machine that represent a pet-like robot behavior; this robot moves in a 3D simulation using Gazebo and is equipped with an RGB camera. Using that camera, is able to recognize a ball that moves around in the environment, following the user's commands.</p>
<h3>System architecture</h3>
<p>This is a graph of the system architecture (obtained via rqt-graph):</p>
<div class="image">
<img src="system_architecture.png" alt="system_architecture.png"/>
<div class="caption">
System Architecture</div></div>
<h5>Implemented nodes</h5>
<p>The node <code>state_miro</code> contains the state machine that will be described right after this paragraph. The node <code>cmd_generator</code> sends commands to the ball's action server (<code>reaching_goal</code>) and moves it in the space or makes it disappear; the commands could be sent by the user or could be random. The node <code>image_feature</code> receives the image from the camera and if detects a ball sends a message to the <code>state_miro</code> node; when the state machine will change state, this node will also send <code>cmd_vel</code> messages to the robot depending on the distance from the ball. The node <code>reaching_goal2</code> is the robot action server. </p><h3>System states</h3>
<p>This is a graph of the possible states (obtained via smach-viewer):</p>
<div class="image">
<img src="state_machine.png" alt="state_machine.png"/>
<div class="caption">
System Architecture</div></div>
<p> The possible states are: </p><ul>
<li>
<code>SLEEP</code>, the robot is sleeping and so it wont respond to any command. After a while in any other state, even if not commanded to do so, it reaches location [-6,-6]. After some amount of time, the robot goes again in state NORMAL . </li>
<li>
<p class="startli"><code>NORMAL</code>, the robot is in the predefined state, it moves randomly around the map until he detects the ball in his lane of sight: the robot will than pass to the <code>PLAY</code> state. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><code>PLAY</code>, the robot enters in this state from the <code>NORMAL</code> one after seeing the ball: it chases it until it stops moving, than moves his head 45Â° to the left and to the right, then it continues staring the ball until it moves. If the ball disappears, the robot will go back to the <code>NORMAL</code> state.</p>
<p class="endli">&gt;</p>
</li>
</ul>
<h5>Packages and file list</h5>
<p>The only package that is present is <code>exp_assignment2</code>, which contains all the executable files. In particular, we have:</p>
<ul>
<li><code>src</code> folder: <pre class="fragment">  - `moveclient.cpp`: contains the code to rotate the robot neck of a certain angle;
</pre></li>
<li><code>scripts</code> folder:<ul>
<li><code><a class="el" href="state__machine__miro__ext_8py.html">state_machine_miro_ext.py</a></code>: is the state machine of the robot;</li>
<li><code><a class="el" href="ball__c_8py.html">ball_c.py</a></code> and <code><a class="el" href="ball__c__random_8py.html">ball_c_random.py</a></code> that are responsible for the generation of the command for the ball, the first program recevies input from the user and the second generates them randomly, the node is called <code>cmd_generator</code>.</li>
</ul>
</li>
</ul>
<p><code><a class="el" href="go__to__point__action_8py.html">go_to_point_action.py</a></code>: contains the code for the action server of the robot, reads the goal from the <code>reaching_goal2/goal</code> topic, where the node <code>miro_state machine</code> writes a coordinate; the node is called <code>reaching_goal2</code>.</p><ul>
<li><code><a class="el" href="go__to__point__ball_8py.html">go_to_point_ball.py</a></code>: contains the code for the action server of the ball, reads the goal from the <code>reaching_goal/goal</code> topic, where the node <code>cmd_generator</code> writes a coordinate;the node is called <code>reaching_goal</code>.</li>
<li><code><a class="el" href="robot__following3_8py.html">robot_following3.py</a></code>: contains the code <code>image_feature</code>, this node perform the blob detection on the image from the camera and if the robot is in the <code>PLAY</code> state also sends <code>cmd_vel</code> commands to the robot.</li>
</ul>
<p><code>launch</code> folder:</p><ul>
<li><code>display.launch</code>: launch file that launches Rviz to check the model of the robot;</li>
<li><code>gazebo_world2.launch</code>: launches the simulation where commands are received from the user;</li>
<li><code>gazebo_world2_random.launch</code>: launches the simulation where commands are generated randomlycd;</li>
</ul>
<h3>Installation</h3>
<p>This is a ROS package, so it will be necessary to clone this repository into the <code>src</code> folder of a ROS workspace (here is assumed to be named <code>my_ros</code>):</p>
<pre class="fragment">cd ~/my_ros/src
git clone
catkin_make --pkg exp_assignment2
</pre><p>Some packages are needed: smach-viewer cv_bridge actionlib actionlib_msgs image_transport </p>
<h3>Run the simulation</h3>
<p>To easily run the simulation i created a launch file, that can be used this way:</p>
<pre class="fragment">source ~/my_ros/devel/setup.bash 
roslaunch exp_assignment2 gazebo_world2_random.launch
</pre><p>This runs the random simulation, the state of the robot and its position in the space will be outputted on the shell with the information about the command received and an eventual change of state.</p>
<p>If you want to interact with the simulation by givin commands you have to run: </p><pre class="fragment">source ~/my_ros/devel/setup.bash 
roslaunch exp_assignment2 gazebo_world2.launch
</pre><p>and then open a new shell and run: </p><pre class="fragment">source ~/my_ros/devel/setup.bash 
rosrun exp_assignment2 ball_c.py 
</pre><p> A command line interface willconsent to send commands to move the ball or make it disappear.</p>
<p>For both, an additional window will open: this contains the output image from the robot's camera. </p>
<h3>System features</h3>
<p>The system features a finite-state machine using the <code>Smach</code> packet and a simulation done via Gazebo: the robot contains a "navigation by following" appproach, using "color blob recognition" to recognize a green ball in the image provied by the camera; the robot itself features the camera, two actuated joints (the wheels) and an additional one, the neck, that can be moved around the roll axis. The system also features the possibility to be controlled by the user or behave fully randomly.</p>
<p>This is the robot:</p>
<div class="image">
<img src="robot.png" alt="robot.png"/>
<div class="caption">
map</div></div>
<h3>System limitation</h3>
<p>Sometimes the ball movement makes the robot "roll" on itself and goes into a position where it cannot moved anymore and have to be "flipped" manually from the user. </p>
<h3>Possible improvements</h3>
<h3>Documentation</h3>
<p>The documentation is accessible in: </p><pre class="fragment">./doc/html/index.html
</pre><h3>Contacts</h3>
<p>Riccardo Lastrico - 4070551</p>
<p>Email: <a href="#" onclick="location.href='mai'+'lto:'+'rik'+'y.'+'las'+'tr'+'ico'+'@g'+'mai'+'l.'+'com'; return false;">riky.<span style="display: none;">.nosp@m.</span>last<span style="display: none;">.nosp@m.</span>rico@<span style="display: none;">.nosp@m.</span>gmai<span style="display: none;">.nosp@m.</span>l.com</a> </p>
</div></div><!-- contents -->

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/exp_assignment2">exp_assignment2</a><br />
Author(s): </br />
<small>autogenerated on Tue Dec 8 2020 16:51:03</small>
</div>
</body>
</html>
